!function(a){function b(b,c){var d=new Image;d.src=c,d.complete?b.css("background-image",'url("'+c+'")'):(b.css("background-image","url('images/wpspin_light.gif')"),a(d).load(function(){b.css("background-image",'url("'+c+'")')}))}var c=function(b){function c(b){var c=f.$t.find(".provider_list_select");c.empty().after('<img class="op-bsw-waiting" src="images/wpspin_light.gif" alt="loading" style="position:relative;display:block;top:4px">'),a.post(OptimizePress.ajaxurl,{action:OptimizePress.SN+"-email-provider-items",provider:b},function(d){switch(f.lists=d.lists,b){case"infusionsoft":case"aweber":case"mailchimp":case"icontact":case"getresponse":case"campaignmonitor":case"officeautopilot":var e=[];a.each(d.lists,function(b,c){e.push(a("<option/>",{value:b,text:c.name}))}),e.sort(function(a,b){return a.text().toLowerCase()>b.text().toLowerCase()?1:-1}),c.empty().append(e)}c.next().remove(),"undefined"!=typeof c.attr("data-default")&&c.val(c.attr("data-default")),c.trigger("change")},"json")}function d(b){var b=a(b),c=f.$t.find(b.hasClass("name_select")?".email_select":".name_select"),d=b.val(),e=c.val();d==e&&c.find('option[value!="'+d+'"]:eq(0)').attr("selected",!0)}function e(){var b='<option value="op_add_new_field">'+op_mod_signup_form.lang.add_new_field+'</option><option value="">-----------------</option>';a.each(f.input_elems,function(a,c){b+='<option value="'+a+'">'+c+"</option>"}),f.els.extra_fields.find("select").each(function(){var c=a(this).find(":selected").attr("value");a(this).html(b).val(c).trigger("change")})}var f=this;f.$t=b,f.tmp_obj=a("<div />"),f.selects=b.find(".field_select").change(function(){d(this)}),f.hdn_div=b.find(".hidden-div"),f.prefix=b.find(".field_prefix").val(),f.idprefix=b.find(".field_idprefix").val(),f.input_elems={},f.lists={},f.els={email_select:b.find(".email_select"),email_selected:b.find(".email_box_selected").val(),name_select:b.find(".name_select"),name_selected:b.find(".name_box_selected").val(),action:b.find(".form_action"),method:b.find(".method_select"),extra_fields:b.find(".extra_fields .op-multirow-container"),email_extra_fields:b.find(".email_data_extra_fields .op-multirow-container")},f.els.email_extra_fields.data("multirow_counter",f.els.email_extra_fields.find(".op-multirow").length),f.els.extra_fields.data("multirow_counter",f.els.extra_fields.find(".op-multirow").length),f.$t.find(".integration_type_select").change(function(){var b,d,e=a(this).val();switch(a(".op-signup_form-form_html").removeClass("op-signup_form-form_html_email"),e){case"email":a(".op-signup_form-form_html").addClass("op-signup_form-form_html_email"),b="p.email_data_field,div.email_data_field,p.new_window",d="div.field-double-optin,p.form_html_field,div.form_html_field,p.provider_list,p.thank_you_page,p.action_page,div.provider_list_note";break;case"custom":case"oneshoppingcart":d="div.field-double-optin,p.email_data_field,div.email_data_field,p.provider_list,p.thank_you_page,p.action_page,div.provider_list_note",b="p.form_html_field,div.form_html_field,p.new_window";break;case"infusionsoft":d="div.field-double-optin,p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.new_window,p.thank_you_page",b="p.provider_list,p.email_html_field,p.name_html_field,div.extra_fields,p.action_page,div.provider_list_note",c(e);break;case"mailchimp":d="p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.new_window,p.action_page,p.email_html_field",b="div.field-double-optin,p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note",c(e);break;case"aweber":case"getresponse":case"icontact":case"campaignmonitor":case"officeautopilot":d="div.field-double-optin,p.email_data_field,p.form_html_field,div.form_html_field,div.email_data_field,p.new_window,p.action_page,p.email_html_field",b="p.provider_list,p.name_html_field,p.thank_you_page,div.extra_fields,div.provider_list_note",c(e)}f.$t.find(d).hide(),f.$t.find(b).show(),a.fancybox.update(),a("body").toggleClass("dummyClass")}).trigger("change"),f.$t.find(".gotowebinar_enabled_select").change(function(){var b=f.$t.find(".gotowebinar_list_field");"Y"==a(this).val()?b.show():b.hide()}).trigger("change"),f.$t.find(".provider_list_select").change(function(){var b=a(this).val();if("string"!=typeof b&&(a(this).val(a(this).find("option:first").val()),b=a(this).val()),f.input_elems={},"undefined"!=typeof f.lists[b])if("undefined"==typeof f.lists[b].fields)a.ajax({type:"POST",url:OptimizePress.ajaxurl,data:{action:OptimizePress.SN+"-email-provider-item-fields",provider:f.$t.find(".integration_type_select").val(),list:b},success:function(c){f.lists[b].fields=c.fields,f.lists[b].action=c.action,f.lists[b].hidden=c.hidden,f.input_elems=f.lists[b].fields,"undefined"!=typeof f.lists[b]&&"undefined"!=typeof f.lists[b].action&&f.$t.find(".action_page input").val(f.lists[b].action),"undefined"!=typeof f.lists[b]&&"undefined"!=typeof f.lists[b].hidden&&a.each(f.lists[b].hidden,function(b,c){f.hdn_div.empty(),f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_name][]" />').val(b)),f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_vals][]" />').val(c))});var d=[];a.each(f.input_elems,function(b,c){d.push(a("<option/>",{value:b,text:c}))});var g=f.$t.find(".name_select");g.empty().append(d),g.val(f.els.name_selected),e()},dataType:"json"});else{f.input_elems=f.lists[b].fields,"undefined"!=typeof f.lists[b]&&"undefined"!=typeof f.lists[b].action&&f.$t.find(".action_page input").val(f.lists[b].action),"undefined"!=typeof f.lists[b]&&"undefined"!=typeof f.lists[b].hidden&&a.each(f.lists[b].hidden,function(b,c){f.hdn_div.empty(),f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_name][]" />').val(b)),f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_vals][]" />').val(c))});var c=[];a.each(f.input_elems,function(b,d){c.push(a("<option/>",{value:b,text:d}))});var d=f.$t.find(".name_select");d.empty().append(c),d.val(f.els.name_selected),e()}}),f.$t.find(".form_html").change(function(){var b=f.tmp_obj;f.input_elems={};try{b.html(a(this).val().replace(/<!--.*-->/g,"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<script.*/gi,""))}catch(c){}var g=b.find("form[action]");f.els.method.val(""),f.els.action.val(""),f.selects.find("option").remove(),f.hdn_div.html(""),g.length>0&&(a("input[name]:not(:button,:submit)",g).each(function(){var b=a(this).attr("name"),c=b==f.els.name_selected?' selected="selected"':"",d=b==f.els.email_selected?' selected="selected"':"";f.els.name_select.append('<option value="'+b+'"'+c+">"+b+"</option>"),f.els.email_select.append('<option value="'+b+'"'+d+">"+b+"</option>"),f.input_elems[b]=b}),"undefined"!=typeof f.input_elems.name&&f.els.name_select.val("name"),"undefined"!=typeof f.input_elems.email&&f.els.email_select.val("email"),a(":input",f.tmp_obj).each(function(){var b=a(this).attr("name");"undefined"!=typeof b&&(f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_name][]" />').val(b)),f.hdn_div.append(a('<input type="hidden" name="'+f.prefix+'[fields][field_vals][]" />').val(a(this).val())))}),f.els.action.val(g.attr("action")),f.els.method.val((g.attr("method")||"post").toLowerCase()),d(f.els.name_select),e())}).keyup(function(){a(this).trigger("change")}).trigger("change"),f.$t.find(".disable_name").change(function(){f.$t.find(".name_input").parent().toggle(!a(this).is(":checked")),f.$t.find(".name_order").parent().toggle(!a(this).is(":checked")),f.$t.find(".name_required").parent().toggle(!a(this).is(":checked"))}).trigger("change"),f.els.extra_fields.delegate("select","change",function(){var b=a(this).val(),c="hide",d=!1,e=a(this).parent().next();("op_add_new_field"==b||""==b)&&(c="show",d=!0),e[c](),d&&e.find(":input").focus()}).add(f.els.email_extra_fields).delegate('a[href$="#remove"]',"click",function(b){b.preventDefault(),a(this).closest(".op-multirow").remove()}),f.els.extra_fields.find(".op-multirow").each(function(){var b=a(this).find('input[name="selected_value"]');b.length>0&&a(this).find("select").val(b.val()).trigger("change")}),f.els.extra_fields.next().click(function(a){a.preventDefault();var b=f.els.extra_fields.data("multirow_counter");b++,f.els.extra_fields.data("multirow_counter",b);var c=f.idprefix+"extra_field_"+b+"_";f.els.extra_fields.append('<div class="op-multirow cf"><div><label for="'+c+'field_name">'+op_mod_signup_form.lang.field_name+'</label><select name="'+f.prefix+'[extra_fields][field_name][]" id="'+c+'field_name"><option value="op_add_new_field">'+op_mod_signup_form.lang.add_new_field+'</option><option value="">-----------------</option></select></div><div><input type="text" name="'+f.prefix+'[extra_fields][title][]" id="'+c+'title" /></div><div class="form_html_field_with_order"><label for="'+c+'text">'+op_mod_signup_form.lang.text+'</label><input type="text" name="'+f.prefix+'[extra_fields][text][]" id="'+c+'text" /></div><div class="form_html_field_order"><label for="'+c+'order">'+op_mod_signup_form.lang.order+'</label><input type="text" name="'+f.prefix+'[extra_fields][order][]" id="'+c+'order" /></div><div class="form_html_field_required"><label for="'+c+'required">'+op_mod_signup_form.lang.required+'</label><input type="checkbox" name="'+f.prefix+'[extra_fields][required][]" id="'+c+'required" /></div><div class="op-multirow-controls"><a href="#remove"><img alt="'+op_mod_signup_form.lang.remove+'" src="'+OptimizePress.imgurl+'remove-row.png" /></a></div></div>').find("div.op-multirow:last select").trigger("change"),e()}),f.els.email_extra_fields.next().click(function(a){a.preventDefault();var b=f.els.email_extra_fields.data("multirow_counter");b++,f.els.email_extra_fields.data("multirow_counter",b);var c=f.idprefix+"email_extra_field_"+b;f.els.email_extra_fields.append('<div class="op-multirow cf"><div class="form_html_field_with_order"><label for="'+c+'">'+op_mod_signup_form.lang.text+'</label><input type="text" name="'+f.prefix+'[email_extra_fields][]" id="'+c+'" /></div><div class="form_html_field_order"><label for="'+c+'order">'+op_mod_signup_form.lang.order+'</label><input type="text" name="'+f.prefix+'[email_extra_fields_order][]" id="'+c+'order" /></div><div class="form_html_field_required"><label for="'+c+'required">'+op_mod_signup_form.lang.required+'</label><input type="checkbox" name="'+f.prefix+'[email_extra_fields_required][]" id="'+c+'required" /></div><div class="op-multirow-controls"><a href="#remove"><img alt="'+op_mod_signup_form.lang.remove+'" src="'+OptimizePress.imgurl+'remove-row.png" /></a></div></div>').find("div.op-multirow:last input").focus()})};a(document).ready(function(){a(".op-signup_form-form_html").each(function(){new c(a(this))}),a(".module-signup_form .color_scheme_selector").change(function(){var c=a(this),d=a(this).closest(".tab-color_scheme"),e=d.find(".section_name").val();"undefined"!=typeof op_mod_signup_form.styles[e]&&b(d.find(".preview"),op_mod_signup_form.styles[e][c.val()].preview)}).trigger("change")})}(opjq);